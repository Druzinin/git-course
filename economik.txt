pz6

SELECT DISTINCT city FROM customers;
SELECT DISTINCT rating FROM customers;
SELECT DISTINCT comm FROM salespeople;
SELECT * FROM salespeople WHERE city='London';
SELECT * from salespeople WHERE comm>0.12;
SELECT * from customers where city='Rome';
SELECT * FROM customers WHERE rating=100 or rating=300;
SELECT * FROM orders where amt<1000;
SELECT * from customers where city='Rome' and rating=200;
SELECT * from customers where city='Berlin' or rating=300;

pz 6.1

SELECT * from customers where snum in(1001, 1002, 1007);
select * from orders where cnum in(2001, 2004, 2008);
SELECT * from salespeople where snum BETWEEN 1001 and 1005;
SELECT * from salespeople where comm BETWEEN 0.10 and 0.13;
SELECT * from customers where cname BETWEEN 'A%' and 'H%';
SELECT * from customers where city BETWEEN 'A%' and 'M%';
SELECT * from orders where odate BETWEEN '2021-03-10' and '2021-05-10';
SELECT * FROM customers WHERE cname like 'C%';
SELECT * FROM customers WHERE cname like 'G%';
SELECT * FROM customers WHERE cname like 'G%s';

pz7

SELECT COUNT(snum) AS 'Количество продавцов' FROM salespeople;
SELECT COUNT(DISTINCT city) AS 'Города продавцов' FROM salespeople;
SELECT COUNT(*) AS 'Количество строк' FROM customers;
SELECT Sum(rating) AS 'Общий рейтинг заказчиков' FROM customers;
SELECT sum(amt) as 'Сумма заказов' FROM orders;
SELECT avg(rating) as 'Средний рейтинг заказчиков' FROM customers;
SELECT avg(amt) as 'Средняя стоимость заказов' FROM orders;
SELECT min(rating) as 'Минимальный рейтинг заказчика' FROM customers;
SELECT max(comm) as 'Максимальная комиссия продавца' FROM salespeople;
SELECT sum(amt+dostavka) as 'Общая стоимость заказа' FROM orders;
SELECT cname, city, rating/50 FROM customers;
SELECT sname, city, sin(comm)*10 FROM salespeople;
SELECT 'id заказчика', cnum, cname, city FROM customers;
SELECT 'id продавца', snum, sname, city, 'комиссионные продавца', comm FROM salespeople;

pz8

SELECT sum(amt) FROM orders WHERE odate='2021-03-10';
SELECT COUNT(DISTINCT city) FROM customers;
SELECT cnum, min(amt) FROM orders GROUP by cnum;
SELECT snum, odate, min(amt) FROM orders GROUP by snum, odate;
SELECT cnum, min(amt) FROM orders GROUP BY cnum HAVING cnum in(2004,2006,2008);
SELECT * FROM customers WHERE cname LIKE 'G%' ORDER BY cname;
SELECT city, max(rating) FROM customers GROUP by city;
SELECT odate, COUNT(DISTINCT snum) FROM orders GROUP by odate;
SELECT snum, odate, COUNT(onum) FROM orders GROUP by snum, odate;

pz8.1

SELECT rating, cname FROM customers order by 1;
SELECT salespeople.sname, customers.cname FROM salespeople, customers WHERE customers.snum = salespeople.snum order by sname;
SELECT snum, sname, city from salespeople order by sname desc;
SELECT cname, city, rating FROM customers order by rating, cname;
SELECT sname, city FROM salespeople GROUP by city order by sname;
SELECT cname, city, rating FROM customers GROUP by 2;
SELECT city, COUNT(DISTINCT rating) FROM customers GROUP by city order by 2;

pz9

SELECT sname, cname, amt FROM salespeople, customers, orders WHERE (amt>700 and amt <2000) and orders.cnum = customers.cnum and orders.snum = salespeople.snum;
SELECT sname, (amt-(amt*comm)) FROM salespeople, orders WHERE orders.snum = salespeople.snum;
SELECT sname, cname FROM salespeople, customers WHERE customers.snum = salespeople.snum order by sname;
SELECT sname, cname, customers.city FROM salespeople, customers WHERE customers.snum = salespeople.snum and customers.city = salespeople.city;
SELECT odate, comm FROM orders, salespeople WHERE orders.snum = salespeople.snum and comm < 0.12;
SELECT amt, rating FROM orders, customers WHERE orders.cnum = customers.cnum and rating > 100;
SELECT cname, odate FROM orders, customers WHERE orders.cnum = customers.cnum and odate='2021-03-10';
SELECT cname, amt, comm, odate FROM salespeople, orders, customers WHERE orders.cnum = customers.cnum and orders.snum = salespeople.snum and odate = '2021-04-10';
SELECT cname, rating, amt, odate FROM orders, customers where orders.cnum = customers.cnum and amt>3000 and odate='2021-03-10';
SELECT onum, sname, cname, customers.city FROM orders, salespeople, customers WHERE orders.cnum = customers.cnum and salespeople.snum = orders.snum and customers.city = 'San Jose' and salespeople.city = 'San Jose' AND salespeople.city = customers.city;

pz10

SELECT a.sname, b.sname, a.city FROM salespeople a, salespeople b WHERE a.city = b.city and a.sname < b.sname;
SELECT a.cname, b.cname, a.rating from customers a, customers b WHERE a.rating = b.rating and a.cname < b.cname;
SELECT a.onum, b.onum, customers.cname FROM orders a, orders b, customers WHERE a.cnum = b.cnum and a.cnum = customers.cnum and b.cnum = customers.cnum and a.onum < b.onum;
SELECT a.cname, a.city, b.cname, b.city, a.rating FROM customers a, customers b WHERE a.rating = b.rating and a.cname < b.cname;
SELECT cname, city, rating FROM customers WHERE rating = (SELECT rating FROM customers WHERE cnum = 2001);
6
SELECT cnum, odate FROM orders WHERE odate in('2021-04-10', '2021-05-10');
SELECT cname, sname FROM orders, customers, salespeople WHERE orders.cnum = customers.cnum and orders.snum = salespeople.snum and (sname = 'Peel' or sname = 'Serres');
SELECT a.amt, b.amt, a.odate FROM orders a, orders b WHERE a.odate in('2021-05-10', '2021-06-10') and b.odate in('2021-05-10', '2021-06-10') and a.amt < b.amt;
SELECT a.sname, b.sname, a.comm FROM salespeople a, salespeople b WHERE a.comm = b.comm and a.sname < b.sname;

pz11

SELECT * FROM orders WHERE cnum = (SELECT DISTINCT cnum FROM customers WHERE cname = 'Hoffman');
SELECT * FROM orders WHERE snum = (SELECT snum FROM salespeople WHERE city = 'New York');
SELECT * FROM customers WHERE snum = (SELECT snum FROM salespeople WHERE sname = 'Motika');
SELECT * FROM salespeople WHERE snum = (SELECT snum from orders WHERE cnum =(SELECT cnum FROM customers WHERE cname = 'Liu') );
SELECT * FROM orders WHERE cnum = (SELECT cnum FROM customers WHERE rating=100 and city='Rome');

pz12

SELECT customers.cname, customers.rating, avg(amt) FROM customers,orders WHERE customers.cnum = orders.cnum GROUP BY orders.cnum
SELECT customers.cname, customers.rating FROM customers WHERE rating < (SELECT avg(rating) from customers ) and city = 'Rome'
SELECT salespeople.sname, salespeople.comm FROM salespeople WHERE salespeople.snum = (SELECT DISTINCT(snum) FROM customers WHERE customers.city = 'Paris')
SELECT COUNT(orders.onum) FROM orders WHERE amt < (SELECT avg(amt) FROM orders) and orders.odate = '2021-03-10'
SELECT salespeople.sname, salespeople.snum from salespeople WHERE (salespeople.snum + 1000) = (SELECT cnum from customers WHERE customers.city = 'Berlin')
SELECT snum, sum(amt) from orders GROUP BY snum HAVING sum(amt) > (SELECT max(amt) from orders)

pz13

SELECT cname, city, 'Высокий рейтинг' as 'Рейтинг', rating FROM customers WHERE rating >= 200 UNION SELECT cname, city, 'Низкий рейтинг', rating FROM customers WHERE rating< 200
SELECT orders.snum as 'id', sname as 'name', count(onum) FROM salespeople, orders WHERE salespeople.snum = orders.snum GROUP by orders.snum HAVING COUNT(onum) > 1 UNION SELECT orders.cnum, cname, COUNT(onum) FROM customers, orders WHERE customers.cnum = orders.cnum GROUP by orders.cnum HAVING COUNT(onum) > 1 order by 2
SELECT snum as 'id', city FROM salespeople WHERE city = 'San Jose' GROUP by snum UNION SELECT cnum, city FROM customers WHERE city = 'San Jose' GROUP by cnum UNION SELECT onum, odate FROM orders WHERE odate = '2021-03-10' GROUP by onum

pzANY_ALL

SELECT sname, cname, salespeople.city FROM salespeople, customers WHERE salespeople.city = customers.city and customers.snum = salespeople.snum
SELECT sname, comm FROM salespeople WHERE comm > all(SELECT comm FROM salespeople WHERE city='London')
SELECT * FROM orders WHERE amt < all(SELECT amt FROM orders WHERE odate= '2021-04-10')
SELECT snum, sum(amt) FROM orders GROUP by snum HAVING sum(amt) >= all(SELECT sum(amt) FROM orders GROUP by snum)
SELECT sname, orders.snum, sum(amt) FROM orders, salespeople WHERE salespeople.snum = orders.snum GROUP by snum HAVING sum(amt) >= all(SELECT sum(amt) FROM orders GROUP by snum)

pz14

CREATE view 14_1 as SELECT * FROM customers WHERE rating = 300
CREATE view 14_2 as SELECT cname as CnameZ FROM customers WHERE cname like 'C%'
CREATE view 14_3 as SELECT * FROM salespeople WHERE city = 'London'
CREATE view 14_4 as SELECT * FROM orders WHERE amt > 1000
CREATE view 14_5 as SELECT * FROM orders WHERE odate BETWEEN '2021-03-01' and '2021-04-01'
CREATE view 14_6 as SELECT * FROM customers WHERE rating = (SELECT max(rating) FROM customers)
CREATE view 14_7 as SELECT orders.snum, sname, orders.cnum, cname, avg(amt), max(amt) FROM orders, salespeople, customers WHERE orders.cnum = customers.cnum and orders.snum = salespeople.snum GROUP by orders.snum, orders.cnum
CREATE view 14_8 as SELECT city, count(snum) FROM salespeople GROUP by city
CREATE view 14_9 as SELECT sname, comm FROM salespeople, customers WHERE customers.snum = salespeople.snum and customers.city in('Rome', 'San Jose')
CREATE view 14_10 as SELECT orders.snum, sname, avg(amt), sum(amt) FROM salespeople, orders WHERE salespeople.snum = orders.snum GROUP by orders.snum
CREATE view 14_11 as SELECT onum, amt, dostavka, oplata, odate, orders.cnum, orders.snum FROM orders, salespeople WHERE orders.snum = salespeople.snum and salespeople.city = 'London'
CREATE view 14_12 as SELECT sname, count(customers.snum) FROM salespeople, customers WHERE customers.snum = salespeople.snum GROUP by salespeople.snum HAVING COUNT(customers.snum) > 1
CREATE view 14_13 as SELECT salespeople.snum, sname FROM salespeople, orders WHERE salespeople.snum = orders.snum and odate BETWEEN '2021-03-31' and '2021-05-01'

pzOKONNIE

SELECT sname, comm, city, row_number() over(order by city) 'Номер уникальности', max(comm) over(partition by city) 'Максимальная комиссия в каждом городе' FROM salespeople
SELECT odate, amt, sname, sum(amt) over(partition by orders.snum) 'Накопительная сумма стоимости заказов' FROM salespeople, orders WHERE salespeople.snum = orders.snum
--- SELECT cname, amt, max(amt) over(partition by orders.cnum) 'Максимальная стоимость заказа для каждого заказчика' FROM customers, orders WHERE customers.cnum = orders.cnum

19

19

1 SELECT sname, cname, amt FROM orders inner join salespeople using(snum) inner join customers using(cnum) WHERE amt > 700 and amt < 2000
2 SELECT sname, amt-(amt*comm) FROM orders inner join salespeople using(snum)
3 SELECT sname, cname FROM customers inner join salespeople using(snum)
4 SELECT sname, cname, city FROM customers inner join salespeople using(snum, city)
5 SELECT odate, comm FROM orders inner join salespeople using(snum) WHERE comm < 0.12
6 SELECT amt, rating FROM orders inner join customers using(cnum) WHERE rating > 100
7 SELECT cname, odate FROM orders inner join customers using(cnum) WHERE odate='2021-03-10'
8 SELECT cname, amt, comm, odate FROM orders inner join salespeople using(snum) inner JOIN customers using(cnum) WHERE odate = '2021-04-10'
9 SELECT cname, rating, amt, odate FROM orders inner join customers using(cnum) WHERE amt > 3000 and odate='2021-03-10'
10 SELECT onum, sname, cname, city FROM customers inner join salespeople using(snum, city) inner JOIN orders using(cnum, snum) WHERE city = 'San Jose's
